// Generated by CoffeeScript 2.7.0
import {
  echo,
  global,
  range,
  settings
} from './global.js';

import {
  performance
} from './rating.js';

export var Player = class Player {
  constructor(id, name, elo1) {
    this.id = id;
    this.name = name;
    this.elo = elo1;
    this.opp = []; // används endast av Floating
    this.col = ""; // används endast av Floating
    this.summa = 0;
    this.P = 0;
    this.PR = 0;
  }

  balance() {
    var b, c, j, len, ref;
    b = 0;
    ref = this.col;
    for (j = 0, len = ref.length; j < len; j++) {
      c = ref[j];
      if (c === 'w') {
        b++;
      }
      if (c === 'b') {
        b--;
      }
    }
    return b;
  }

  toString() {
    return `${String(this.elo).padStart(4, '0')} ${this.name}`;
  }

  getElos(long) {
    var ch, elo, j, len, opp, r, ref, value;
    this.P = 0;
    this.PR = 0;
    this.elos = [this.elo, ':'];
    ref = range(settings.GAMES * settings.ROUNDS);
    for (j = 0, len = ref.length; j < len; j++) {
      r = ref[j];
      ch = long[r][3];
      value = '012'.indexOf(ch);
      opp = long[r][1];
      if (value !== -1) {
        elo = global.players[opp].elo;
        this.P += value / 2;
        if (elo !== 0) {
          this.PR += value / 2;
          this.elos.push(Math.round(elo));
        }
      } else {
        this.elos.push('    ');
      }
    }
    this.elos.push(this.PR);
    return this.elos.join(' ');
  }

  update_P_and_PR(longs, i) {
    var andel, ch, elo, j, len, long, opp, perf, r, ref, value;
    long = longs[i];
    //echo 'longs',longs
    this.P = 0;
    this.PR = 0;
    this.elos = [];
    ref = range(settings.GAMES * settings.ROUNDS);
    for (j = 0, len = ref.length; j < len; j++) {
      r = ref[j];
      ch = long[r][3];
      value = '012'.indexOf(ch);
      opp = long[r][1];
      if (value !== -1) {
        elo = global.players[opp].elo;
        this.P += value / 2;
        if (elo !== 0) {
          this.PR += value / 2;
          this.elos.push(Math.round(elo));
        }
      }
    }
    // kalkylera performance rating mha vinstandel och elo-tal
    if (this.elos.length === 0) {
      return this.PR = 0;
    } else {
      andel = this.PR;
      perf = performance(andel, this.elos);
      return this.PR = perf;
    }
  }

};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGxheWVyLmpzIiwic291cmNlUm9vdCI6IlxcIiwic291cmNlcyI6WyJwbGF5ZXIuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFBO0VBQVEsSUFBUjtFQUFhLE1BQWI7RUFBb0IsS0FBcEI7RUFBMEIsUUFBMUI7Q0FBQSxNQUFBOztBQUNBLE9BQUE7RUFBUSxXQUFSO0NBQUEsTUFBQTs7QUFFQSxPQUFBLElBQWEsU0FBTixNQUFBLE9BQUE7RUFFTixXQUFjLEdBQUEsTUFBQSxNQUFBLENBQUE7SUFBQyxJQUFDLENBQUE7SUFBSSxJQUFDLENBQUE7SUFBTSxJQUFDLENBQUE7SUFDM0IsSUFBQyxDQUFBLEdBQUQsR0FBTyxHQUFUO0lBQ0UsSUFBQyxDQUFBLEdBQUQsR0FBTyxHQURUO0lBRUUsSUFBQyxDQUFBLEtBQUQsR0FBUztJQUNULElBQUMsQ0FBQSxDQUFELEdBQUs7SUFDTCxJQUFDLENBQUEsRUFBRCxHQUFNO0VBTE87O0VBT2QsT0FBVSxDQUFBLENBQUE7QUFDWCxRQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLEdBQUEsRUFBQTtJQUFFLENBQUEsR0FBSTtBQUNKO0lBQUEsS0FBQSxxQ0FBQTs7TUFDQyxJQUFHLENBQUEsS0FBSyxHQUFSO1FBQWlCLENBQUEsR0FBakI7O01BQ0EsSUFBRyxDQUFBLEtBQUssR0FBUjtRQUFpQixDQUFBLEdBQWpCOztJQUZEO1dBR0E7RUFMUzs7RUFPVixRQUFXLENBQUEsQ0FBQTtXQUFHLENBQUEsQ0FBQSxDQUFHLE1BQUEsQ0FBTyxJQUFDLENBQUEsR0FBUixDQUFZLENBQUMsUUFBYixDQUFzQixDQUF0QixFQUF5QixHQUF6QixDQUFILEVBQUEsQ0FBQSxDQUFtQyxJQUFDLENBQUEsSUFBcEMsQ0FBQTtFQUFIOztFQUVYLE9BQVUsQ0FBQyxJQUFELENBQUE7QUFDWCxRQUFBLEVBQUEsRUFBQSxHQUFBLEVBQUEsQ0FBQSxFQUFBLEdBQUEsRUFBQSxHQUFBLEVBQUEsQ0FBQSxFQUFBLEdBQUEsRUFBQTtJQUFFLElBQUMsQ0FBQSxDQUFELEdBQUs7SUFDTCxJQUFDLENBQUEsRUFBRCxHQUFNO0lBQ04sSUFBQyxDQUFBLElBQUQsR0FBUSxDQUFDLElBQUMsQ0FBQSxHQUFGLEVBQU8sR0FBUDtBQUNSO0lBQUEsS0FBQSxxQ0FBQTs7TUFDQyxFQUFBLEdBQUssSUFBSSxDQUFDLENBQUQsQ0FBRyxDQUFDLENBQUQ7TUFDWixLQUFBLEdBQVEsS0FBSyxDQUFDLE9BQU4sQ0FBYyxFQUFkO01BQ1IsR0FBQSxHQUFNLElBQUksQ0FBQyxDQUFELENBQUcsQ0FBQyxDQUFEO01BQ2IsSUFBRyxLQUFBLEtBQVMsQ0FBQyxDQUFiO1FBQ0MsR0FBQSxHQUFNLE1BQU0sQ0FBQyxPQUFPLENBQUMsR0FBRCxDQUFLLENBQUM7UUFDMUIsSUFBQyxDQUFBLENBQUQsSUFBTSxLQUFBLEdBQU07UUFDWixJQUFHLEdBQUEsS0FBTyxDQUFWO1VBQ0MsSUFBQyxDQUFBLEVBQUQsSUFBTyxLQUFBLEdBQU07VUFDYixJQUFDLENBQUEsSUFBSSxDQUFDLElBQU4sQ0FBVyxJQUFJLENBQUMsS0FBTCxDQUFXLEdBQVgsQ0FBWCxFQUZEO1NBSEQ7T0FBQSxNQUFBO1FBT0MsSUFBQyxDQUFBLElBQUksQ0FBQyxJQUFOLENBQVcsTUFBWCxFQVBEOztJQUpEO0lBYUEsSUFBQyxDQUFBLElBQUksQ0FBQyxJQUFOLENBQVcsSUFBQyxDQUFBLEVBQVo7V0FDQSxJQUFDLENBQUEsSUFBSSxDQUFDLElBQU4sQ0FBVyxHQUFYO0VBbEJTOztFQW9CVixlQUFrQixDQUFDLEtBQUQsRUFBTyxDQUFQLENBQUE7QUFDbkIsUUFBQSxLQUFBLEVBQUEsRUFBQSxFQUFBLEdBQUEsRUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLElBQUEsRUFBQSxHQUFBLEVBQUEsSUFBQSxFQUFBLENBQUEsRUFBQSxHQUFBLEVBQUE7SUFBRSxJQUFBLEdBQU8sS0FBSyxDQUFDLENBQUQsRUFBZDs7SUFFRSxJQUFDLENBQUEsQ0FBRCxHQUFLO0lBQ0wsSUFBQyxDQUFBLEVBQUQsR0FBTTtJQUNOLElBQUMsQ0FBQSxJQUFELEdBQVE7QUFDUjtJQUFBLEtBQUEscUNBQUE7O01BQ0MsRUFBQSxHQUFLLElBQUksQ0FBQyxDQUFELENBQUcsQ0FBQyxDQUFEO01BQ1osS0FBQSxHQUFRLEtBQUssQ0FBQyxPQUFOLENBQWMsRUFBZDtNQUNSLEdBQUEsR0FBTSxJQUFJLENBQUMsQ0FBRCxDQUFHLENBQUMsQ0FBRDtNQUNiLElBQUcsS0FBQSxLQUFTLENBQUMsQ0FBYjtRQUNDLEdBQUEsR0FBTSxNQUFNLENBQUMsT0FBTyxDQUFDLEdBQUQsQ0FBSyxDQUFDO1FBQzFCLElBQUMsQ0FBQSxDQUFELElBQU0sS0FBQSxHQUFNO1FBQ1osSUFBRyxHQUFBLEtBQU8sQ0FBVjtVQUNDLElBQUMsQ0FBQSxFQUFELElBQU8sS0FBQSxHQUFNO1VBQ2IsSUFBQyxDQUFBLElBQUksQ0FBQyxJQUFOLENBQVcsSUFBSSxDQUFDLEtBQUwsQ0FBVyxHQUFYLENBQVgsRUFGRDtTQUhEOztJQUpELENBTEY7O0lBaUJFLElBQUcsSUFBQyxDQUFBLElBQUksQ0FBQyxNQUFOLEtBQWdCLENBQW5CO2FBQ0MsSUFBQyxDQUFBLEVBQUQsR0FBTSxFQURQO0tBQUEsTUFBQTtNQUdDLEtBQUEsR0FBUSxJQUFDLENBQUE7TUFDVCxJQUFBLEdBQU8sV0FBQSxDQUFZLEtBQVosRUFBbUIsSUFBQyxDQUFBLElBQXBCO2FBQ1AsSUFBQyxDQUFBLEVBQUQsR0FBTSxLQUxQOztFQWxCaUI7O0FBdENaIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtlY2hvLGdsb2JhbCxyYW5nZSxzZXR0aW5nc30gZnJvbSAnLi9nbG9iYWwuanMnXHJcbmltcG9ydCB7cGVyZm9ybWFuY2V9IGZyb20gJy4vcmF0aW5nLmpzJ1xyXG5cclxuZXhwb3J0IGNsYXNzIFBsYXllclxyXG5cclxuXHRjb25zdHJ1Y3RvciA6IChAaWQsIEBuYW1lLCBAZWxvKSAtPlxyXG5cdFx0QG9wcCA9IFtdICMgYW52w6RuZHMgZW5kYXN0IGF2IEZsb2F0aW5nXHJcblx0XHRAY29sID0gXCJcIiAjIGFudsOkbmRzIGVuZGFzdCBhdiBGbG9hdGluZ1xyXG5cdFx0QHN1bW1hID0gMFxyXG5cdFx0QFAgPSAwXHJcblx0XHRAUFIgPSAwXHJcblxyXG5cdGJhbGFuY2UgOiAtPlxyXG5cdFx0YiA9IDBcclxuXHRcdGZvciBjIGluIEBjb2xcclxuXHRcdFx0aWYgYyA9PSAndycgdGhlbiBiKytcclxuXHRcdFx0aWYgYyA9PSAnYicgdGhlbiBiLS1cclxuXHRcdGJcclxuXHJcblx0dG9TdHJpbmcgOiAtPiBcIiN7U3RyaW5nKEBlbG8pLnBhZFN0YXJ0IDQsICcwJ30gI3tAbmFtZX1cIlxyXG5cclxuXHRnZXRFbG9zIDogKGxvbmcpIC0+XHJcblx0XHRAUCA9IDBcclxuXHRcdEBQUiA9IDBcclxuXHRcdEBlbG9zID0gW0BlbG8sICc6J11cclxuXHRcdGZvciByIGluIHJhbmdlIHNldHRpbmdzLkdBTUVTICogc2V0dGluZ3MuUk9VTkRTXHJcblx0XHRcdGNoID0gbG9uZ1tyXVszXVxyXG5cdFx0XHR2YWx1ZSA9ICcwMTInLmluZGV4T2YgY2hcclxuXHRcdFx0b3BwID0gbG9uZ1tyXVsxXVxyXG5cdFx0XHRpZiB2YWx1ZSAhPSAtMVxyXG5cdFx0XHRcdGVsbyA9IGdsb2JhbC5wbGF5ZXJzW29wcF0uZWxvXHJcblx0XHRcdFx0QFAgKz0gdmFsdWUvMlxyXG5cdFx0XHRcdGlmIGVsbyAhPSAwXHJcblx0XHRcdFx0XHRAUFIgKz0gdmFsdWUvMlxyXG5cdFx0XHRcdFx0QGVsb3MucHVzaCBNYXRoLnJvdW5kIGVsb1xyXG5cdFx0XHRlbHNlXHJcblx0XHRcdFx0QGVsb3MucHVzaCAnICAgICdcclxuXHRcdFx0XHJcblx0XHRAZWxvcy5wdXNoIEBQUlxyXG5cdFx0QGVsb3Muam9pbiAnICdcclxuXHJcblx0dXBkYXRlX1BfYW5kX1BSIDogKGxvbmdzLGkpIC0+XHJcblx0XHRsb25nID0gbG9uZ3NbaV1cclxuXHRcdCNlY2hvICdsb25ncycsbG9uZ3NcclxuXHRcdEBQID0gMFxyXG5cdFx0QFBSID0gMFxyXG5cdFx0QGVsb3MgPSBbXVxyXG5cdFx0Zm9yIHIgaW4gcmFuZ2Ugc2V0dGluZ3MuR0FNRVMgKiBzZXR0aW5ncy5ST1VORFNcclxuXHRcdFx0Y2ggPSBsb25nW3JdWzNdXHJcblx0XHRcdHZhbHVlID0gJzAxMicuaW5kZXhPZiBjaFxyXG5cdFx0XHRvcHAgPSBsb25nW3JdWzFdXHJcblx0XHRcdGlmIHZhbHVlICE9IC0xXHJcblx0XHRcdFx0ZWxvID0gZ2xvYmFsLnBsYXllcnNbb3BwXS5lbG9cclxuXHRcdFx0XHRAUCArPSB2YWx1ZS8yXHJcblx0XHRcdFx0aWYgZWxvICE9IDBcclxuXHRcdFx0XHRcdEBQUiArPSB2YWx1ZS8yXHJcblx0XHRcdFx0XHRAZWxvcy5wdXNoIE1hdGgucm91bmQgZWxvXHJcblxyXG5cdFx0IyBrYWxreWxlcmEgcGVyZm9ybWFuY2UgcmF0aW5nIG1oYSB2aW5zdGFuZGVsIG9jaCBlbG8tdGFsXHJcblx0XHRpZiBAZWxvcy5sZW5ndGggPT0gMCBcclxuXHRcdFx0QFBSID0gMFxyXG5cdFx0ZWxzZVxyXG5cdFx0XHRhbmRlbCA9IEBQUlxyXG5cdFx0XHRwZXJmID0gcGVyZm9ybWFuY2UgYW5kZWwsIEBlbG9zXHJcblx0XHRcdEBQUiA9IHBlcmZcclxuIl19
//# sourceURL=c:\github\FairPair\player.coffee